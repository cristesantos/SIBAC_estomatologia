


package regras

import com.exemplo.estomatologia.model.Sintomas;
import com.exemplo.estomatologia.model.Diagnostico;

rule "Gengiva Saudável"
when
    $s : Sintomas(dor == "pouca", vermelho == "pouco", tartaro == false, lesoes == false)
then
    double[] valores = new double[] {
        $s.getFCDor(),
        $s.getFCVermelho(),
        $s.getFCTartaro(),
        $s.getFCLesoes()
    };
    double fc = combinarFCs(valores);
    insert(new Diagnostico("Gengiva saudável", fc));
end

rule "Gengivite Leve"
when
    $s : Sintomas(dor == "pouca", vermelho == "pouco", tartaro == false)
then
    double[] valores = new double[] {
        $s.getFCDor(),
        $s.getFCVermelho()
    };
    double fc = combinarFCs(valores);
    insert(new Diagnostico("Gengivite leve", fc));
end

rule "Gengivite Moderada"
when
    $s : Sintomas(dor == "média", vermelho == "médio", tartaro == true)
then
    double[] valores = new double[] {
        $s.getFCDor(),
        $s.getFCVermelho(),
        $s.getFCTartaro()
    };
    double fc = combinarFCs(valores);
    insert(new Diagnostico("Gengivite moderada", fc));
end

rule "Gengivite Grave"
when
    $s : Sintomas(dor == "muita", vermelho == "muito", lesoes == true)
then
    double[] valores = new double[] {
        $s.getFCDor(),
        $s.getFCVermelho(),
        $s.getFCLesoes()
    };
    double fc = combinarFCs(valores);
    insert(new Diagnostico("Gengivite grave", fc));
end

rule "Periodontite Inicial"
when
    $s : Sintomas(dor == "média", vermelho == "muito", tartaro == true)
then
    double[] valores = new double[] {
        $s.getFCDor(),
        $s.getFCVermelho(),
        $s.getFCTartaro()
    };
    double fc = combinarFCs(valores);
    insert(new Diagnostico("Periodontite inicial", fc));
end

rule "Periodontite Avançada (abscesso)"
when
    $s : Sintomas(abscesso == true)
then
    double[] valores = new double[] {
        $s.getFCAbscesso()
    };
    double fc = combinarFCs(valores);
    insert(new Diagnostico("Periodontite avançada", fc));
end

rule "Periodontite Avançada (dor e vermelho)"
when
    $s : Sintomas(dor == "muita", vermelho == "muito")
then
    double[] valores = new double[] {
        $s.getFCDor(),
        $s.getFCVermelho()
    };
    double fc = combinarFCs(valores);
    insert(new Diagnostico("Periodontite avançada", fc));
end

// Função para combinar fatores de certeza
function double combinarFCs(double[] valores) {
    if (valores.length == 0) return 0.0;
    double resultado = valores[0];
    for (int i = 1; i < valores.length; i++) {
        resultado = resultado + valores[i] * (1 - resultado);
    }
    return resultado;
}
